<modification>    <id>POS Menu Item</id>    <version>1.9</version>    <vqmver>2.x</vqmver>    <author>Krafty Solutions</author>    <file name="admin/view/template/sale/order_info.tpl">    <operation>            <search position="after"><![CDATA[<td><?php echo $payment_method; ?></td>]]></search>            <add><![CDATA[          </tr>          <tr>            <td>Card no.</td>            <td><?php echo $card_no; ?></td>]]></add>    </operation>    </file>    <file name="admin/controller/sale/order.php">    <operation>            <search position="before"><![CDATA[$this->data['shipping_firstname'] = $order_info['shipping_firstname']]></search>            <add><![CDATA[$this->data['card_no'] = $order_info['card_no'];]]></add>    </operation>    </file>    <file name="admin/model/sale/order.php">    <operation>            <search position="before"><![CDATA['shipping_firstname'      => $order_query->row['shipping_firstname']]></search>            <add><![CDATA['card_no' => $order_query->row['card_no'],]]></add>    </operation>    <operation>            <search position="before"><![CDATA[if (!empty($data['filter_total'])) {]]></search>            <add><![CDATA[                if(!empty($data['filter_user_id'])){                    $sql .= " AND user_id = '" . (float)$data['filter_user_id'] . "'";                }            ]]></add>    </operation>    </file>    <file name="admin/model/user/user.php">    <operation>            <search position="before"><![CDATA[public function getTotalUsersByEmail]]></search>            <add><![CDATA[             public function getUsersByGroupId($user_group_id) {		$query = $this->db->query("SELECT user_id, username FROM `" . DB_PREFIX . "user` WHERE user_group_id = '" . (int)$user_group_id."'");        	return $query->rows;             }            ]]></add>    </operation>    </file>    <file name="admin/controller/common/login.php">    <operation>            <search position="replace"><![CDATA[$this->template = 'common/login.tpl']]></search>            <add><![CDATA[             if((isset($_GET['route']) && $_GET['route'] == 'pos/pos') || isset($_POST['is_pos'])){                    $this->load->model('user/user');                    $user_group_id = $this->config->get('pos_user_group_id');                    $this->data['users'] = $this->model_user_user->getUsersByGroupId($user_group_id);                    $this->template = 'pos/login.tpl';                }else{                    $this->template = 'common/login.tpl';                }            ]]></add>            <search position="before"><![CDATA[protected function validate]]></search>            <add><![CDATA[                public function validate_ajax() {                    if (!isset($this->request->post['username']) || !isset($this->request->post['password']) || !$this->user->login($this->request->post['username'], $this->request->post['password'])) {                       $json['error'] = 'Error: Invalid username or password.';                    }else{                       $this->session->data['token'] = md5(mt_rand());                       $json['success'] = 'Success';                       $json['token'] = $this->session->data['token'];                    }                    echo json_encode($json);                }             ]]></add>    </operation>    </file>    <file name="admin/controller/common/login.php">    <operation>        <search position="after"><![CDATA[$this->session->data['token'] = md5(mt_rand());]]></search>        <add><![CDATA[            $pos_user_group_id = $this->config->get('pos_user_group_id');            $this->load->model('user/user');            $user = $this->model_user_user->getUser($this->user->getId());            $has_permission = $this->user->hasPermission('access','pos/pos');            if($pos_user_group_id == $user['user_group_id'] && $has_permission){               $this->redirect($this->url->link("pos/pos/index").'&token=' . $this->session->data['token']);            }        ]]></add>    </operation>    </file>    <file name="system/engine/loader.php">        <operation>            <search position="replace"><![CDATA[model($model)]]></search>            <add><![CDATA[                    model($model, $is_pos=false)                ]]></add>        </operation>        <operation>            <search position="replace"><![CDATA[$file  = DIR_APPLICATION . 'model/' . $model . '.php';]]></search>            <add><![CDATA[                    if($is_pos){                        $file  = DIR_CATALOG . 'model/' . $model . '.php';                    }else{                        $file  = DIR_APPLICATION . 'model/' . $model . '.php';                    }                ]]></add>        </operation>    </file>    <file name="system/library/language.php">        <operation>            <search position="replace"><![CDATA[load($filename)]]></search>            <add><![CDATA[                    load($filename,$is_pos_gateway=false)                ]]></add>        </operation>        <operation>            <search position="replace"><![CDATA[$file = DIR_LANGUAGE . $this->directory . '/' . $filename . '.php';]]></search>            <add><![CDATA[                    if($is_pos_gateway){                        $file = DIR_CATALOG.'language/'. $this->directory . '/' . $filename . '.php';                    }else{                        $file = DIR_LANGUAGE . $this->directory . '/' . $filename . '.php';                    }                ]]></add>        </operation>        <operation>            <search position="replace"><![CDATA[$file = DIR_LANGUAGE . $this->default . '/' . $filename . '.php';]]></search>            <add><![CDATA[                    if($is_pos_gateway){                        $file = DIR_CATALOG.'language/'. $this->directory . '/' . $filename . '.php';                    }else{                        $file = DIR_LANGUAGE . $this->default . '/' . $filename . '.php';                    }                ]]></add>        </operation>    </file>    <file name="catalog/controller/checkout/success.php">        <operation>            <search position="before"><![CDATA[if (isset($this->session->data['order_id']))]]></search>            <add><![CDATA[                if(isset($this->session->data['is_for_pos']) && $this->session->data['is_for_pos']){                    $this->session->data['is_for_pos'] = false;                    $this->redirect($this->url->link('pos/index/success', '', 'SSL'));                }            ]]></add>    </operation>    </file>    <file name="system/library/mail.php">    <operation>        <search position="after"><![CDATA[send() {]]></search>         <add><![CDATA[                if (!$this->to){                    return true;                }         ]]></add>    </operation>    </file></modification>